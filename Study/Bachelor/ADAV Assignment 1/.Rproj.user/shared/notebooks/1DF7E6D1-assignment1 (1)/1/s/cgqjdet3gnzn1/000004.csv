"0",""
"0",""
"0",""
"0",""
"0",""
"0","#For the second plot, we created a correlation matrix to look at the correlation between the different hobbies and interests and shopping behaviour. "
"0","cormat <- cor(data[-33], data$shopping_beh)"
"0",""
"0","#Reshape the data to make it suitable for the plot"
"0","melted_cormat <- melt(cormat)"
"0","melted_cormat$Var1<-str_replace_all(melted_cormat$Var1, ""[.]"", "" "") # Convert names"
"0","melted_cormat$posneg <- ifelse(melted_cormat$value > 0, ""apos"", ""neg"")  # influence flag"
"0","melted_cormat <- melted_cormat[order(melted_cormat$value), ]  # sort"
"0","melted_cormat$Var1 <- factor(melted_cormat$Var1, levels = melted_cormat$Var1)  # convert to factor to retain sorted order in plot."
"0",""
"0","# plot2"
"0","ggplot(melted_cormat, aes(x=Var1, y=value, label=value)) + "
"0","  geom_bar(stat='identity', aes(fill=posneg), width=0.6)  +"
"0","  scale_fill_manual(name=""Type of effect"", "
"0","                    labels = c(""Positive effect"", ""Negative effect""), "
"0","                    values = c(""apos""=""#00ba38"", ""neg""=""#f8766d"")) + "
"0","  labs(subtitle=""Effect of hobbies on shopping behaviour"", "
"0","       title= ""Diverging Bar Plot"","
"0","       x = 'Type of interest',"
"0","       y = 'Influence Value') + "
"0","  coord_flip()"
